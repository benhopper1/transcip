var constructor=new function(){console.log("HOPPER JQUERY EXTENTION CONSTRUCTOR RUNNING"),$("body").append($(document.createElement("div")).attr("id","validationRulesDiv"))};$.fn.blink=function(e,t){var n=$(this).get(0);$(n).addClass("blink"),$(n).data("blinkPostFunction",t);var a=function(e){$(e).fadeOut(250,function(){$(this).fadeIn(250,function(){$(this).hasClass("blink")&&a(e)})})};if(e&&e>0){var o=setTimeout(function(){$(n).removeClass("blink");var e=$(n).data("blinkPostFunction");e&&e(!0)},e);$(n).data("expireTimer",o)}a(n)},$.fn.unblink=function(){var e=$(this).get(0),t=$(e).data("expireTimer");t&&clearTimeout(t),$(e).removeClass("blink");var n=$(e).data("blinkPostFunction");n&&n(!1)},$.fn.getCss=function(){var e=$(this).get(0),t=function(e){var t,n={};if(window.getComputedStyle){t=window.getComputedStyle(e,null);for(var a=0,o=t.length;o>a;a++){var i=t[a],r=t.getPropertyValue(i);n[i]=r}return n}if(e.currentStyle){t=e.currentStyle;for(var i in t)n[i]=t[i];return n}if(t=e.style){for(var i in t)"function"!=typeof t[i]&&(n[i]=t[i]);return n}return n};return t(e)},$.fn.validate=function(e){"phoneNumber"==e&&($(this).val().length=11)};var listViewHash={};$.fn.listViewAppend=function(e){var t={id:(new Date).getTime(),"class":"listViewClass",imageUrl:"BAD URL",name:"NO NAME",number:"NO NUMBER",type:"NO TYPE",state:!1};t=$.extend(t,e);var n='<li id="'+t.id+'" class="menu_li '+t.class+'"  data-inset="true"> <a "/hjhjhjh"> '+t.name+' <img src="'+t.imageUrl+'" class="magicCirc" style"height:50px; width:50px; object-fit: cover;" /> <p>'+t.number+"</p> <p>"+t.type+"</p> </a> </li>";return t.html=n,listViewHash[t.id]=t,$(this).append(n),$(this).listview().listview("refresh"),t.id},$.fn.getListViewArray=function(){return listViewHash},$.fn.getListView=function(e){return listViewHash[e]},$.fn.listViewRemove=function(e){var t=listViewHash[e];t&&(delete listViewHash[e],$("#"+e).remove())},$.fn.form_checkbox_add=function(e){var t={caption:"noCaption",id:(new Date).getTime(),isChecked:!1};t=$.extend(t,e);var n=function(e){var t='<label style="background-color: transparent !important;" for="'+e.id+'">'+e.caption+'</label><input type="checkbox" name="'+e.id+'" id="'+e.id+'"/>';return t};if(!$(this).data("elementArray")){var a=[];$(this).data("elementArray",a)}return $(this).data("elementArray").push(t),$(this).find(".ui-controlgroup-controls").append(n(t)),$(this).trigger("create"),t.isChecked?$("#"+t.id).prop("checked",!0).checkboxradio("refresh"):$("#"+t.id).removeAttr("checked").checkboxradio("refresh"),t.id},$.fn.form_checkbox_getValueById=function(e){return $(this).data("elementArray")?$("#"+e).prop("checked"):!1},$.fn.form_checkbox_getValueByIndex=function(e){var t=$(this).data("elementArray");return t?$("#"+t[e].id).prop("checked"):!1},$.fn.form_checkbox_getData=function(){var e=$(this).data("elementArray");if(!$(this).data("elementArray"))return!1;for(var t in e)e[t].isChecked=$("#"+e[t].id).prop("checked");return e},$.fn.form_checkbox_getCheckedData=function(){var e=$(this).form_checkbox_getData();resultArray=[];for(var t in e)e[t].isChecked&&resultArray.push(e[t].data);return resultArray},$.fn.form_checkbox_clear=function(){$(this).data("elementArray");return $(this).data("elementArray")?($(this).find(" .ui-controlgroup-controls").empty(),$(this).removeData("elementArray"),void $(this).trigger("create")):!1},$.fn.form_checkbox_removeById=function(e){var t=$(this).data("elementArray");if(!$(this).data("elementArray"))return!1;$("#"+e).parent().children().remove();for(var n in t)t[n].id==e&&t.splice(n,1)},$.fn.form_checkbox_removeByIndex=function(e){var t=$(this).data("elementArray");return $(this).data("elementArray")?($("#"+t[e].id).siblings().remove(),$("#"+t[e].id).remove(),void t.splice(e,1)):!1},$.fn.HorizontalRadioGroup=function(e,t){var n=$(this).data("horizontalRadioGroupInstance");if(!n||"create"==e){t.divRef=$(this),console.log("HorizontalRadioGroup CREATED");var n=new HorizontalRadioGroup(t);return void $(this).data("horizontalRadioGroupInstance",n)}return"test"==e&&n.test(),"load"==e&&n.load(),"getSelected"==e?n.getSelected():"setSelected"==e?n.setSelected(t):void 0};var HorizontalRadioGroup=function(e){var t,n=this,a={id:(new Date).getTime(),"class":"",dataTheme:"a",dataType:"horizontal",legend:"",radioArray:[],onSelect:!1};a=$.extend(a,e),t=a.divRef;var o=function(){var e='<form id="'+a.id+'"><fieldset data-role="controlgroup" data-mini="true" data-theme="'+a.dataTheme+'" data-type="'+a.dataType+'" class="horizontalRadioGroupClass '+a.class+'" ><legend>'+a.legend+"</legend>",t="";for(var n in a.radioArray){var o={id:a.id+"_"+n,caption:"NO CAPTION","class":"HorizontalRadioControlClass",value:"off",checked:!1};o=$.extend(o,a.radioArray[n]);var i="";1==o.checked&&(i='checked="checked"');var r='<input type="radio" name="'+a.id+'" id="'+o.id+'" value="'+o.value+'" '+i+'><label for="'+o.id+'">'+o.caption+"</label>";t+=r}var c="</fieldset></form>";return e+t+c};this.load=function(){$(t).html(o()),$(t).checkboxradio().trigger("create"),$(t).change(function(){a.onSelect&&a.onSelect(n.getSelected())})},this.test=function(){alert("HorizontalRadioGroup TEST!!!")},this.getSelected=function(){var e=$(t).find("input:checked");return $("label[for='"+$(e).attr("id")+"']").text()},this.setSelected=function(e){if($.isNumeric(e)){var n=a.id+"_"+e;$("#"+n).trigger("click"),$("#"+n).trigger("click")}else $(t).find(" .ui-radio input").each(function(){e==$("label[for='"+$(this).attr("id")+"']").text()&&($(this).trigger("click"),$(this).trigger("click"))})}},DataBinderObject=function(e){var t,n=this,a=!1,o="edit",i={id:"dataBinder_"+(new Date).getTime(),toJsonProcess:!1,clearProcess:!1,saveProcess:!1,loadProcess:!1,whenDirtyTransition:!1,onSave:!1,onCancel:!1};i=$.extend(i,e),t=i.divRef,this.test=function(){alert("DataBinderObject TEST")},this.toJson=function(){return i.toJsonProcess?i.toJsonProcess():(console.log("toJsonProcess NOT INCLUDED IN CONSTRUCTOR!!!"),!1)},this.clear=function(){return i.clearProcess?i.clearProcess():(console.log("clearProcess NOT INCLUDED IN CONSTRUCTOR!!!"),!1)},this.save=function(e){if(!i.saveProcess)return console.log("saveProcess NOT INCLUDED IN CONSTRUCTOR!!!"),!1;if(e||(e=o,console.log("======================================"),console.log("MODE:"+e)),n.isDirty()){n.setDirtyMark();var t=function(e){i.onSave&&i.onSave(e)},a=function(e){i.onCancel&&i.onCancel(e)};return console.log("SAVE----------"),console.dir(n.toJson()),i.saveProcess(n.toJson(),e,t,a)}return!1},this.load=function(e){if(!i.loadProcess)return console.log("loadProcess NOT INCLUDED IN CONSTRUCTOR!!!"),!1;if(n.isDirty()&&i.whenDirtyTransition){var t=function(){var t=i.loadProcess(e);return n.setDirtyMark(),t};return i.whenDirtyTransition(n.toJson(),n.save,t)}var a=i.loadProcess(e);return n.setDirtyMark(),a},this.setDirtyMark=function(){a=$.getHash.md5(JSON.stringify(n.toJson())),console.log("dirtyMarkOut:"+a)},this.isDirty=function(){return!(a==$.getHash.md5(JSON.stringify(n.toJson())))},this.setMode=function(e){return o=e,!0},n.setDirtyMark()};$.fn.DataBinderObject=function(e,t){var n=$(this).data("dataBinderObjectInstance");if(!n||"create"==e){t.divRef=$(this),console.log("dataBinderObject CREATED");var n=new DataBinderObject(t);return void $(this).data("dataBinderObjectInstance",n)}return"test"==e&&n.test(),"load"==e?n.load(t):"save"==e?n.save(t):"clear"==e?n.clear():"setDirtyMark"==e?n.setDirtyMark():"isDirty"==e?n.isDirty():"setMode"==e?n.setMode(t):"toJson"==e?n.toJson():void 0};var dynamicPopup=function(){var e,t,n,a,o,i=$.mobile.activePage;this.init=function(n){return e=$.extend({content:"",popupId:"popup"+i.attr("id"),"data-theme":"a","data-overlay-theme":"none","data-position-to":"window","data-rel":"back","data-dismissible":!0,"data-transition":"none","data-arrow":!1},n),"string"==typeof n&&(e.content=n),this.createPopupElements(),this.populatePopupContent(),this.putPopupInDOM(),this.openPopup(),t},this.createPopupElements=function(){t=$("#"+e.popupId),t.length?(n=t,a=t.find(".ui-popup-content"),o=t.find(".ui-popup-close-btn")):(n=$("<div></div>").attr({id:e.popupId,"data-role":"popup","data-theme":e["data-theme"],"data-position-to":e["data-position-to"],"data-dismissible":e["data-dismissible"],"data-transition":e["data-transition"],"data-arrow":e["data-arrow"]}).addClass("ui-popup-main transparent"),a=$("<div></div>").attr({"data-role":"content"}).addClass("ui-content ui-popup-content transparent"),o=$("<a></a>").attr({href:"#","data-role":"button","data-rel":e["data-rel"]}).addClass("transparent ui-btn ui-corner-all ui-shadow ui-btn-a ui-icon-delete ui-btn-icon-notext ui-btn-right ui-popup-close-btn"))},this.populatePopupContent=function(){"string"==typeof e.content&&a.html(e.content),e.content instanceof jQuery&&a.html(e.content.html())},this.putPopupInDOM=function(){t.remove(),n.append(o).append(a),i.append(n)},this.openPopup=function(){t=$("#"+e.popupId),t.popup(e),t.popup("open")}};$.DynamicPopup=function(e){var t=new dynamicPopup;return t.init(e)},$.DynamicPopupYesNo=function(e){var t={message:"NO MESSAGE",subMessage:"NO SUBMESSAGE",yesCaption:"YES",noCaption:"NO",onYes:!1,onNo:!1};t=$.extend(t,e);var n=""+sprintf('<h3 class="ui-title">%s</h3>',t.message)+sprintf("<p>%s</p>",t.subMessage)+sprintf('<a id="popupDialog_yes" href="#" data-role="button" data-inline="true" data-rel="back" data-theme="c" data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" class="ui-btn ui-shadow ui-btn-corner-all ui-btn-inline ui-btn-up-c"><span class="ui-btn-inner ui-btn-corner-all"><span class="ui-btn-text">%s</span></span></a>',t.yesCaption)+sprintf('<a id="popupDialog_no" href="#" data-role="button" data-inline="true" data-rel="back" data-theme="c" data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" class="ui-btn ui-shadow ui-btn-corner-all ui-btn-inline ui-btn-up-c"><span class="ui-btn-inner ui-btn-corner-all"><span class="ui-btn-text">%s</span></span></a>',t.noCaption);$.DynamicPopup({content:n,"data-transition":"slideup","data-position-to":"#Register"}).bind({popupafteropen:function(){console.log("Opened the popup!")},popupafterclose:function(){}}),$("#popupDialog_yes").click(function(){t.onYes&&t.onYes()}),$("#popupDialog_no").click(function(){t.onNo&&t.onNo()})},$.getHash=new function(){!function(e){"use strict";function t(e,t){var n=(65535&e)+(65535&t),a=(e>>16)+(t>>16)+(n>>16);return a<<16|65535&n}function n(e,t){return e<<t|e>>>32-t}function a(e,a,o,i,r,c){return t(n(t(t(a,e),t(i,c)),r),o)}function o(e,t,n,o,i,r,c){return a(t&n|~t&o,e,t,i,r,c)}function i(e,t,n,o,i,r,c){return a(t&o|n&~o,e,t,i,r,c)}function r(e,t,n,o,i,r,c){return a(t^n^o,e,t,i,r,c)}function c(e,t,n,o,i,r,c){return a(n^(t|~o),e,t,i,r,c)}function d(e,n){e[n>>5]|=128<<n%32,e[(n+64>>>9<<4)+14]=n;var a,d,s,l,u,p=1732584193,h=-271733879,f=-1732584194,$=271733878;for(a=0;a<e.length;a+=16)d=p,s=h,l=f,u=$,p=o(p,h,f,$,e[a],7,-680876936),$=o($,p,h,f,e[a+1],12,-389564586),f=o(f,$,p,h,e[a+2],17,606105819),h=o(h,f,$,p,e[a+3],22,-1044525330),p=o(p,h,f,$,e[a+4],7,-176418897),$=o($,p,h,f,e[a+5],12,1200080426),f=o(f,$,p,h,e[a+6],17,-1473231341),h=o(h,f,$,p,e[a+7],22,-45705983),p=o(p,h,f,$,e[a+8],7,1770035416),$=o($,p,h,f,e[a+9],12,-1958414417),f=o(f,$,p,h,e[a+10],17,-42063),h=o(h,f,$,p,e[a+11],22,-1990404162),p=o(p,h,f,$,e[a+12],7,1804603682),$=o($,p,h,f,e[a+13],12,-40341101),f=o(f,$,p,h,e[a+14],17,-1502002290),h=o(h,f,$,p,e[a+15],22,1236535329),p=i(p,h,f,$,e[a+1],5,-165796510),$=i($,p,h,f,e[a+6],9,-1069501632),f=i(f,$,p,h,e[a+11],14,643717713),h=i(h,f,$,p,e[a],20,-373897302),p=i(p,h,f,$,e[a+5],5,-701558691),$=i($,p,h,f,e[a+10],9,38016083),f=i(f,$,p,h,e[a+15],14,-660478335),h=i(h,f,$,p,e[a+4],20,-405537848),p=i(p,h,f,$,e[a+9],5,568446438),$=i($,p,h,f,e[a+14],9,-1019803690),f=i(f,$,p,h,e[a+3],14,-187363961),h=i(h,f,$,p,e[a+8],20,1163531501),p=i(p,h,f,$,e[a+13],5,-1444681467),$=i($,p,h,f,e[a+2],9,-51403784),f=i(f,$,p,h,e[a+7],14,1735328473),h=i(h,f,$,p,e[a+12],20,-1926607734),p=r(p,h,f,$,e[a+5],4,-378558),$=r($,p,h,f,e[a+8],11,-2022574463),f=r(f,$,p,h,e[a+11],16,1839030562),h=r(h,f,$,p,e[a+14],23,-35309556),p=r(p,h,f,$,e[a+1],4,-1530992060),$=r($,p,h,f,e[a+4],11,1272893353),f=r(f,$,p,h,e[a+7],16,-155497632),h=r(h,f,$,p,e[a+10],23,-1094730640),p=r(p,h,f,$,e[a+13],4,681279174),$=r($,p,h,f,e[a],11,-358537222),f=r(f,$,p,h,e[a+3],16,-722521979),h=r(h,f,$,p,e[a+6],23,76029189),p=r(p,h,f,$,e[a+9],4,-640364487),$=r($,p,h,f,e[a+12],11,-421815835),f=r(f,$,p,h,e[a+15],16,530742520),h=r(h,f,$,p,e[a+2],23,-995338651),p=c(p,h,f,$,e[a],6,-198630844),$=c($,p,h,f,e[a+7],10,1126891415),f=c(f,$,p,h,e[a+14],15,-1416354905),h=c(h,f,$,p,e[a+5],21,-57434055),p=c(p,h,f,$,e[a+12],6,1700485571),$=c($,p,h,f,e[a+3],10,-1894986606),f=c(f,$,p,h,e[a+10],15,-1051523),h=c(h,f,$,p,e[a+1],21,-2054922799),p=c(p,h,f,$,e[a+8],6,1873313359),$=c($,p,h,f,e[a+15],10,-30611744),f=c(f,$,p,h,e[a+6],15,-1560198380),h=c(h,f,$,p,e[a+13],21,1309151649),p=c(p,h,f,$,e[a+4],6,-145523070),$=c($,p,h,f,e[a+11],10,-1120210379),f=c(f,$,p,h,e[a+2],15,718787259),h=c(h,f,$,p,e[a+9],21,-343485551),p=t(p,d),h=t(h,s),f=t(f,l),$=t($,u);return[p,h,f,$]}function s(e){var t,n="";for(t=0;t<32*e.length;t+=8)n+=String.fromCharCode(e[t>>5]>>>t%32&255);return n}function l(e){var t,n=[];for(n[(e.length>>2)-1]=void 0,t=0;t<n.length;t+=1)n[t]=0;for(t=0;t<8*e.length;t+=8)n[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return n}function u(e){return s(d(l(e),8*e.length))}function p(e,t){var n,a,o=l(e),i=[],r=[];for(i[15]=r[15]=void 0,o.length>16&&(o=d(o,8*e.length)),n=0;16>n;n+=1)i[n]=909522486^o[n],r[n]=1549556828^o[n];return a=d(i.concat(l(t)),512+8*t.length),s(d(r.concat(a),640))}function h(e){var t,n,a="0123456789abcdef",o="";for(n=0;n<e.length;n+=1)t=e.charCodeAt(n),o+=a.charAt(t>>>4&15)+a.charAt(15&t);return o}function f(e){return unescape(encodeURIComponent(e))}function $(e){return u(f(e))}function g(e){return h($(e))}function v(e,t){return p(f(e),f(t))}function m(e,t){return h(v(e,t))}function C(e,t,n){return t?n?v(t,e):m(t,e):n?$(e):g(e)}"function"==typeof define&&define.amd?define(function(){return C}):e.md5=C}(this)};var ComboBox=function(e){var t,n=this,a={id:"comboBox_"+(new Date).getTime(),optionArray:[],usePopup:!1,"class":"",onChange:!1,onSelect:!1};a=$.extend(a,e),t=a.divRef,this.test=function(){alert("ComboBox TEST")},this.addItem=function(e){var t={index:o,id:a.id+"_opt_"+o++,value:"noValue"+(new Date).getTime(),caption:"NO CAPTION"};t=$.extend(t,e),html=""+sprintf('<option id="%s" value="%s"> %s</option>',t.id,t.value,t.caption),$("#"+a.id).append(html)};var o=0,i='<div data-role="fieldcontain" class="">'+sprintf('<select name="%s" class="%s" data-native-menu="%s" data-mini="true" id="%s"/>',a.id,a.class,!a.usePopup,a.id)+"</div>";$(t).html(i);for(var r in a.optionArray)theOption=a.optionArray[r],n.addItem(theOption);$("#"+a.id).change(function(){$(this).val();console.log("change Event"),a.onChange&&a.onChange($(this).prop("selectedIndex"),$(this).children("option:selected").text(),$(this).val(),$(this))}),$("#"+a.id).click(function(){a.onSelect&&a.onSelect($(this).prop("selectedIndex"),$(this).children("option:selected").text(),$(this).val(),$(this))}),$("#"+a.id).selectmenu().selectmenu("refresh",!0),this.changeCaption=function(e,t){var n=a.id+"_opt_"+e;$("#"+n).text(t),$("#"+a.id).selectmenu("refresh")},this.selectByIndex=function(e){var t=a.id+"_opt_"+e;$("#"+t).prop("selected","selected"),$("#"+a.id).selectmenu("refresh"),a.onSelect&&a.onSelect($("#"+a.id).prop("selectedIndex"),$("#"+a.id).children("option:selected").text(),$("#"+a.id).val(),$("#"+a.id))},this.getSelected=function(){var e={index:$("#"+a.id).prop("selectedIndex"),caption:$("#"+a.id).children("option:selected").text(),value:$("#"+a.id).val(),jRef:$("#"+a.id)};return e}};$.fn.ComboBox=function(e,t){var n=$(this).data("comboBoxInstance");if(!n||"create"==e){t.divRef=$(this),console.log("comboBox CREATED");var n=new ComboBox(t);return void $(this).data("comboBoxInstance",n)}return"test"==e&&n.test(),"changeCaption"==e?n.changeCaption(t.index,t.caption):"selectByIndex"==e?n.selectByIndex(t):"getSelected"==e?n.getSelected():void 0},jQuery.extend({compare:function(e,t){var n="[object Object]",a="[object Array]",o=Object.prototype.toString.apply(e),i=Object.prototype.toString.apply(t);return o!==i?!1:o===n?$.compareObject(e,t):o===a?$.compareArray(e,t):e===t}}),jQuery.extend({compareArray:function(e,t){var n,a,o,i,r;if(e===t)return!0;if(e.length!=t.length)return!1;for(n=jQuery.extend(!0,[],e),a=jQuery.extend(!0,[],t),n.sort(),a.sort(),o=0,l=n.length;l>o;o+=1){if(i=Object.prototype.toString.apply(n[o]),r=Object.prototype.toString.apply(a[o]),i!==r)return!1;if($.compare(n[o],a[o])===!1)return!1}return!0}}),jQuery.extend({compareObject:function(e,t){if("object"!=typeof e||"object"!=typeof t)return!1;console.log("compareObject ENTERED");var n,a,o;if(e===t)return!0;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(n in e){if(e.hasOwnProperty(n)){if("undefined"==typeof t[n])return!1;if(a=Object.prototype.toString.apply(e[n]),o=Object.prototype.toString.apply(t[n]),a!==o)return!1}if($.compare(e[n],t[n])===!1)return!1}return!0}}),jQuery.extend({hashToArray:function(e){var t=[];for(var n in e)t.push(e[n]);return t}}),jQuery.extend({isCircular:function(e,t){if(t=t||[],!e||"object"!=typeof e)return!1;var n,a,o=Object.keys(e);for(t.push(e),n=o.length-1;n>=0;n--)if(a=e[o[n]],a&&"object"==typeof a){if(t.indexOf(a)>=0)return!0;if(arguments.callee(a,t))return!0}return t.pop(e),!1}}),jQuery.extend({removeCircular:function(e){function t(e){if(e&&"object"==typeof e){if(-1!==n.indexOf(e))return e;n.push(e);for(var a in e)if(e.hasOwnProperty(a)&&t(e[a]))return e[a]=!1,console.log(e,"cycle at "+a),e}return e}e=$.extend({},e),e.jRef&&(e.jRef=!1);var n=[];return t(e)}}),jQuery.extend({copyObject:function(e){return $.extend(!0,{},e)}}),jQuery.extend({debug:function(e,t){console.info("====================================== %s ============================================",e),console.info(t)}}),jQuery.extend({createContactHashCode:function(e){var t={companyName:e.companyName,department:e.department,emailAddress:e.emailAddress,id:e.id,imageUrl:e.imageUrl,name:e.name,phoneNumber:e.phoneNumber,refNumber:e.refNumber,title:e.title,type:e.type,userId:e.userId};return $.getHash.md5(JSON.stringify(t))}}),jQuery.extend({copyAsOne:function(e,t){return $.extend(!0,{},e,t)}}),jQuery.extend({getDuplicates:function(e){var t,n=[],a={};for(t=0;t<e.length;t++)void 0==a[e[t]]?a[e[t]]++:n.push(e[t]);return $.getUnique(n)}}),jQuery.extend({getUnique:function(e){return $.grep(e,function(t,n){return n==$.inArray(t,e)})}}),jQuery.extend({getKeys:function(e){var t=[];for(var n in e)t.push(n);return t}}),jQuery.extend({getCurrentPageId:function(){return $(":mobile-pagecontainer").pagecontainer("getActivePage")[0].id?$(":mobile-pagecontainer").pagecontainer("getActivePage")[0].id:!1}}),console.log("======================================================================="),console.log("--------------------------JQUERY HOPPER DATABASE-----------------------"),console.log("=======================================================================");var DatabaseObject=function(e){var t=new EventOrigin,n={insertProcess:!1,editProcess:!1,deleteProcess:!1,selectProcess:!1,deleteProcess:!1,onChange:!1};n=$.extend(n,e),this.insert=function(e,a){t.reportOn("onBeforeInsert",e);var o=function(e){a&&a(e),n.onChange&&n.onChange(),t.reportOn("onAfterInsert",e),t.reportOn("onAfterChange",e)};n.insertProcess&&n.insertProcess(e,o)},this.edit=function(e,a){t.reportOn("onBeforeEdit",e);var o=function(e){a&&a(e),n.onChange&&n.onChange(),t.reportOn("onAfterEdit",e),t.reportOn("onAfterChange",e)};n.editProcess&&n.editProcess(e,o)},this.select=function(e,a){t.reportOn("onBeforeSelect",$.extend(!0,{},e));var o=function(e){a&&a($.extend(!0,{},e)),t.reportOn("onAfterSelect",$.extend(!0,{},e))};n.selectProcess&&n.selectProcess($.extend(!0,{},e),o)},this.delete=function(e,a){t.reportOn("onBeforeDelete",e);var o=function(e){a&&a(e),n.onChange&&n.onChange(),t.reportOn("onAfterDelete",e),t.reportOn("onAfterChange",e)};n.deleteProcess&&n.deleteProcess(e,o)},this.getEventObject=function(){return t}},CheckboxLines=function(e,t){var n,a,o,i=this;$(e).data("itemHash",{});var r={id:e.attr("id")?e.attr("id")+"_form":(new Date).getTime()+"_form",formClass:"",formStyle:"background-color: transparent !important",fieldsetClass:"",fieldsetStyle:"background-color: transparent !important",onChange:!1};r=$.extend(r,t),n=r.divRef,this.test=function(){alert("checkboxLines TEST")};var c=function(){var t=$("<form></form>").attr({id:r.id,style:r.formStyle,"data-mini":"true"}).addClass("").addClass(r.formClass),n=$("<fieldset></fieldset>").attr({id:r.id+"_fieldset","data-role":"controlgroup","data-mini":"true",style:r.fieldsetStyle}).addClass("").addClass(r.fieldsetClass);return $(e).append(t),$(t).html(n),a=$(t),o=$(a)};c(),this.editItem=function(t){var n={caption:"noCaption",lookupId:!1,data:!1};n=$.extend(n,t);var a=$(e).data("itemHash")[n.lookupId];a&&(a.data=n.data),$(".sms-pop-"+n.lookupId).html(n.caption)},this.addItem=function(t){var n=(new Date).getTime()+"",c={caption:"noCaption",id:t.id?$(o).attr("id")+"_field_"+t.id:$(o).attr("id")+"_field_"+n,lookupId:t.lookupId?t.lookupId:n,isChecked:!1,"class":"",data:!1};c=$.extend(c,t);var d='<label class="sms-pop-'+c.lookupId+'" style="background-color: transparent !important;" for="'+c.id+'">'+c.caption+'</label><input type="checkbox" name="'+c.id+'" id="'+c.id+'" lookupId="'+c.lookupId+'"/>';return $(o).append(d),c.divLabelRef=$("label[for='"+c.id+"']"),c.divInputRef=$("#"+c.id),$(e).data("itemHash")[c.lookupId]=c,$(o).trigger("create"),console.log("----- itemHash --------"),console.dir($(e).data("itemHash")),i.setCheckbox(c.lookupId,c.isChecked),$(c.divInputRef).change(function(){var t=$(e).data("itemHash")[$(this).attr("lookupId")];t.isChecked=i.isChecked($(this).attr("lookupId")),r.onChange&&r.onChange($(this).attr("lookupId"),t.isChecked,t,a,t.divInputRef,t.divLabelRef)}),c.lookupId},this.setCheckbox=function(t,n){var o=$(e).data("itemHash")[t].divInputRef;$(e).data("itemHash")[t].isChecked=n;var c=i.isChecked(t);n?($(o).prop("checked",!0).checkboxradio("refresh"),c||r.onChange&&r.onChange(t,n,i.getDataByLookupId(t),a,i.getDataByLookupId(t).divInputRef,i.getDataByLookupId(t).divLabelRef)):($(o).removeAttr("checked").checkboxradio("refresh"),c&&r.onChange&&r.onChange(t,n,i.getDataByLookupId(t),a,i.getDataByLookupId(t).divInputRef,i.getDataByLookupId(t).divLabelRef))},this.isChecked=function(t){var n=$(e).data("itemHash")[t].divInputRef;return $(n).prop("checked")},this.getCheckedData=function(){var t=$(e).data("itemHash"),n=[];for(var a in t)t[a].isChecked&&n.push(t[a]);return n},this.getUnCheckedData=function(){var t=$(e).data("itemHash"),n=[];for(var a in t)t[a].isChecked||n.push(t[a]);return n},this.getDataByLookupId=function(t){return $(e).data("itemHash")[t]},this.getData=function(){var t=$(e).data("itemHash"),n=[];for(var a in t)n.push(t[a]);return n},this.setCheckForAll=function(t){"undefined"==typeof t&&(t=!0);var n=$(e).data("itemHash");for(var a in n)i.setCheckbox(n[a].lookupId,t)},this.remove=function(t){var n=$(e).data("itemHash")[t];return n?($(n.divInputRef).parent().remove(),void delete $(e).data("itemHash")[t]):!1},this.clear=function(){$(e).data("itemHash",{}),$(o).children().each(function(){$(this).remove()})},this.getDataArrayFromWrapperArray=function(e){var t=[];for(var n in e)e[n].data&&t.push(e[n].data);return t}};$.fn.CheckboxLines=function(e,t){var n=$(this).data("checkboxLinesInstance");if(!n||"create"==e){t.divRef=$(this),console.log("checkboxLines CREATED");var n=new CheckboxLines($(this),t);return void $(this).data("checkboxLinesInstance",n)}return"test"==e&&n.test(),"addItem"==e?n.addItem(t):"getCheckedData"==e?n.getCheckedData():"getUnCheckedData"==e?n.getUnCheckedData():"setCheckbox"==e?n.setCheckbox(t.lookupId,t.isChecked):"getDataByLookupId"==e?n.getDataByLookupId(t):"getData"==e?n.getData(t):"setCheckForAll"==e?n.setCheckForAll(t):"remove"==e?n.remove(t):"clear"==e?n.clear(t):"getDataArrayFromWrapperArray"==e?n.getDataArrayFromWrapperArray(t):"editItem"==e?n.editItem(t):void 0};var ContactListView=function(e){var t,n=this,a={},o={test:"testVal",onLoadComplete:!1,useCheckbox:!1,autoScrollOnSelect:!1,onLongClick:!1,onClick:!1,onAfterDataLoad:!1,onAddTempContacts:!1,onChange:!1};o=$.extend(o,e),t=o.divRef;var i=$(t).attr("id");this.getTest=function(){return o.test},this.remove=function(e){return a[e]?($(a[e].jRef).remove(),delete a[e],$(t).listview().listview("refresh"),o.onChange&&o.onChange("delete",{id:e}),void n.setSelectedByIndex(0)):!1},this.toggleState=function(e){a[$(e).attr("contactid")].state=!a[$(e).attr("contactid")].state,$(e).buttonMarkup(a[$(e).attr("contactid")].state?{icon:"check",iconpos:"right"}:{icon:"",iconpos:"right"})},this.getSelectedData=function(){var e=[];for(var t in a)a[t].state&&e.push(a[t]);return e},this.getSelected=function(){var e=[];for(var t in a)a[t].state&&e.push(a[t].id);return e},this.getLastSelected=function(){var e=$(".trans-bkg-a-hv.lastSelected").parent().attr("contactid");return e?a[e]:!1},this.refresh=function(e){var t={useUnionCache:!1};t=$.extend(t,e),ContactDataCache.forceRefresh(function(){return t.useUnionCache?void ContactDataCache.getUnionCachedDataArray(function(e){console.log("getUnionCachedDataArray ENETERED"),console.dir(e),n._refresh(e)}):void ContactDataCache.getCachedDataArray(function(e){console.log("getCachedDataArray ENETERED"),n._refresh(e),console.dir(e)})})},this._refresh=function(e){$.debug("_refresh",e);for(contactIndex in e){var d=a[e[contactIndex].id];if(d){console.log("_refresh  ( FOUND RECORD IN HASH  )");var s=$.createContactHashCode(e[contactIndex]);console.log("HASHCODE("+e[contactIndex].name+")(just created):"+s),console.log("HASHCODE("+d.name+")(    old     ):"+d.md5Hash),s!=d.md5Hash?(console.log("_refresh  ( HASH DIFFERENT, EDITS THIS  )"),console.dir(d),r(e[contactIndex].id,e[contactIndex]),a[e[contactIndex].id]=e[contactIndex],a[e[contactIndex].id].md5Hash=s,$(t).listview().listview("refresh"),o.onChange&&o.onChange("edit",e[contactIndex])):console.log("_refresh  ( HASH SAME, DO NOTHING  )")}else{console.log("_refresh  ( !(theRecord)  )"),e[contactIndex].md5Hash=$.createContactHashCode(e[contactIndex]),console.log("_refresh  ( "+e[contactIndex].name+"  ) MD5:"+e[contactIndex].md5Hash);var l=c({id:e[contactIndex].id,"class":"listViewClass",imageUrl:e[contactIndex].imageUrl,name:e[contactIndex].name,number:phoneDisplayFormat(e[contactIndex].phoneNumber),type:e[contactIndex].type});$(t).append(l),e[contactIndex].jRef=$("#"+i+"_"+e[contactIndex].id),a[e[contactIndex].id]=e[contactIndex],$("#"+i+"_"+e[contactIndex].id).click(function(e){console.log("clcik list view AA3 :"+$(e.currentTarget).attr("contactid"));console.dir(e),o.onClick&&(o.useCheckbox&&n.toggleState($(e.currentTarget)),o.onClick($(e.currentTarget).attr("contactid"),a[$(e.currentTarget).attr("contactid")],i+"_"+$(e.currentTarget).attr("contactid")))}),$("#"+i+"_"+e[contactIndex].id).bind("taphold",function(e){o.onLongClick&&o.onLongClick($(e.currentTarget).attr("contactid"),a[$(e.currentTarget).attr("contactid")],i+"_"+$(e.currentTarget).attr("contactid"))}),n.setSelectedByIndex(0);var u=$.extend({},e[contactIndex]);u.jRef=!1,o.onChange&&o.onChange("add",u)}}var p=[];for(var h in e)p.push(e[h].id);console.log("dbArray"),console.dir(p);var f=[];for(var g in a)f.push(a[g].id);console.log("contactListArray"),console.dir(f);var v=arrayDiff(f,p);console.log("removeArray"),console.dir(v);for(var m in v){console.log("DELETE $ID:#"+i+"_"+a[v[m]].id),$("#"+i+"_"+a[v[m]].id).remove();var C=a[v[m]].id,y=a[v[m]].name,b=a[v[m]].type,I=a[v[m]].phoneNumber;delete a[v[m]],o.onChange&&o.onChange("delete",{id:C,name:y,type:b,phoneNumber:I})}v.length&&n.setSelectedByIndex(0),$(t).listview().listview("refresh"),o.onAfterDataLoad&&o.onAfterDataLoad(a)},this.scrollToSelected=function(){console.log("scrollToSelected");var e,a=n.getLastSelected();a&&(e=a.id,console.log("lastSelected"),console.dir(a),console.dir($(t).parent()),$("#"+i+"_"+e).ScrollTo({onlyIfOutside:!0}))},this.addTempContacts=function(e){var r=[];for(contactIndex in e){e[contactIndex].md5Hash=$.createContactHashCode(e[contactIndex]),e[contactIndex].id=e[contactIndex].id?e[contactIndex].id:(new Date).getTime();var d=c({id:e[contactIndex].id?e[contactIndex].id:(new Date).getTime(),"class":"listViewClass",imageUrl:e[contactIndex].imageUrl,name:e[contactIndex].name,number:e[contactIndex].phoneNumber,type:e[contactIndex].type});$(t).append(d),e[contactIndex].jRef=$("#"+i+"_"+e[contactIndex].id),a[e[contactIndex].id]=e[contactIndex],r.push(e[contactIndex]),$("#"+i+"_"+e[contactIndex].id).click(function(e){console.log("clcik list view AA3 :"+$(e.currentTarget).attr("contactid"));console.dir(e),o.onClick&&(o.useCheckbox&&n.toggleState($(e.currentTarget)),o.onClick($(e.currentTarget).attr("contactid"),a[$(e.currentTarget).attr("contactid")],i+"_"+$(e.currentTarget).attr("contactid")))}),$("#"+i+"_"+e[contactIndex].id).bind("taphold",function(e){o.onLongClick&&o.onLongClick($(e.currentTarget).attr("contactid"),a[$(e.currentTarget).attr("contactid")],i+"_"+$(e.currentTarget).attr("contactid"))}),o.onChange&&o.onChange("add",e[contactIndex])}return $(t).listview().listview("refresh"),o.onAddTempContacts&&o.onAddTempContacts(r),r},this.loadData=function(e){var t={useUnionCache:!1,onFinish:!1};t=$.extend(t,e),ContactDataCache.forceRefresh(function(){return t.useUnionCache?void ContactDataCache.getUnionCachedDataArray(function(e){console.log("getUnionCachedDataArray ENETERED"),console.dir(e),n._loadData(e,t.onFinish)}):void ContactDataCache.getCachedDataArray(function(e){console.log("getCachedDataArray ENETERED"),n._loadData(e,t.onFinish),console.dir(e)})})},this._loadData=function(e,r){$.debug("_loadData",e),console.log("TEST_0:"),console.dir(e);for(contactIndex in e){e[contactIndex].md5Hash=$.createContactHashCode(e[contactIndex]),console.log("_loadData  ( "+e[contactIndex].name+"  ) create MD5:"+e[contactIndex].md5Hash);var d=c({id:e[contactIndex].id,"class":"listViewClass",imageUrl:e[contactIndex].imageUrl,name:e[contactIndex].name,number:e[contactIndex].phoneNumber,type:e[contactIndex].type});$(t).append(d),e[contactIndex].jRef=$("#"+i+"_"+e[contactIndex].id),a[e[contactIndex].id]=e[contactIndex],$("#"+i+"_"+e[contactIndex].id).click(function(e){console.log("clcik list view AA3 :"+$(e.currentTarget).attr("contactid"));console.dir(e),o.onClick&&(o.useCheckbox&&n.toggleState($(e.currentTarget)),o.onClick($(e.currentTarget).attr("contactid"),a[$(e.currentTarget).attr("contactid")],i+"_"+$(e.currentTarget).attr("contactid")))}),$("#"+i+"_"+e[contactIndex].id).bind("taphold",function(e){o.onLongClick&&o.onLongClick($(e.currentTarget).attr("contactid"),a[$(e.currentTarget).attr("contactid")],i+"_"+$(e.currentTarget).attr("contactid"))})}$(t).listview().listview("refresh"),r&&r(),o.onAfterDataLoad&&o.onAfterDataLoad(a)},this.getIdByNameAndType=function(e,t){for(var n in a)if(e==a[n].name&&t==a[n].type)return a[n].id;return!1};var r=function(e,t){var r=c({id:e,"class":"listViewClass",imageUrl:t.imageUrl,name:t.name,number:phoneDisplayFormat(t.phoneNumber),type:t.type});$("#"+i+"_"+t.id).replaceWith(r),$("#"+i+"_"+t.id).click(function(e){o.onClick&&(o.useCheckbox&&n.toggleState($(e.currentTarget)),o.onClick($(e.currentTarget).attr("contactid"),a[$(e.currentTarget).attr("contactid")],i+"_"+$(e.currentTarget).attr("contactid")))}),$("#"+i+"_"+t.id).bind("taphold",function(e){o.onLongClick&&o.onLongClick($(e.currentTarget).attr("contactid"),a[$(e.currentTarget).attr("contactid")],i+"_"+$(e.currentTarget).attr("contactid"))})},c=function(e){var t={id:(new Date).getTime(),"class":"listViewClass",imageUrl:"BAD URL",name:"NO NAME",number:"NO NUMBER",type:"NO TYPE"};t=$.extend(t,e);var n="",a='<li id="'+i+"_"+t.id+'" contactId="'+t.id+'" class="menu_li checkbox_click_'+i+"_"+t.class+'"  data-icon="false" data-inset="true"> <a "/hjhjhjh" class="trans-bkg-a-hv" style="'+n+'" > '+t.name+' <img src="'+t.imageUrl+'" style="margin: 15px 15px; height:50px; width:50px;  object-fit: cover;" class="magicSquare" /> <p>'+phoneDisplayFormat(t.number)+"</p> <p>"+t.type+"</p> </a> </li>";
return a};this.initEvent=function(){},this.setState=function(e){o.state=e},this.setSelectedByNameAndType=function(e){var t={name:"",type:""};t=$.extend(t,e);var i=t.name,r=t.type;for(var c in a)if(i==a[c].name&&r==a[c].type)return $("#"+$(o.divRef).attr("id")+"_"+a[c].id).find(".trans-bkg-a-hv").trigger("click"),void(o.autoScrollOnSelect&&n.scrollToSelected())},this.setSelectedById=function(e){if(!(e in a))return!1;var t=a[e].id;t&&($("#"+$(o.divRef).attr("id")+"_"+t).find(".trans-bkg-a-hv").trigger("click"),o.autoScrollOnSelect&&n.scrollToSelected())},this.setSelectedByIndex=function(e){return Object.keys(a).length?!1:e>Object.keys(a).length-1?!1:($("#"+$(o.divRef).attr("id")+"_"+a[Object.keys(a)[0]].id).find(".trans-bkg-a-hv").trigger("click"),void(o.autoScrollOnSelect&&n.scrollToSelected()))},this.findFirstByPhoneNumber=function(e){for(var t in a)if(phoneNumberCompare(a[t].phoneNumber,e))return a[t];return!1}};$.fn.ContactListView=function(e,t){var n=$(this).data("contactListViewInstance");if(!n||"create"==e){t.divRef=$(this),console.log("ContactListView CREATED");var n=new ContactListView(t);return void $(this).data("contactListViewInstance",n)}return"test"==e&&(n=$(this).data("contactListViewInstance")),"refresh"==e&&(n=$(this).data("contactListViewInstance"),n.refresh(t)),"loadData"==e&&(n=$(this).data("contactListViewInstance"),n.loadData(t),n.initEvent()),"getSelectedData"==e?(n=$(this).data("contactListViewInstance"),n.getSelectedData()):"getSelected"==e?(n=$(this).data("contactListViewInstance"),n.getSelected()):"remove"==e?(n=$(this).data("contactListViewInstance"),n.remove(t)):"setSelectedByNameAndType"==e?n.setSelectedByNameAndType(t):"getIdByNameAndType"==e?n.getIdByNameAndType(t.name,t.type):"getLastSelected"==e?n.getLastSelected():"setSelectedByIndex"==e?n.setSelectedByIndex(t):"scrollToSelected"==e?n.scrollToSelected(t):"findFirstByPhoneNumber"==e?n.findFirstByPhoneNumber(t):"addTempContacts"==e?n.addTempContacts(t):"setSelectedById"==e?n.setSelectedById(t):void 0},console.log("============================================================="),console.log("--------------- POPUP LIST VIEW -----------------------------"),console.log("=============================================================");var PopupListView=function(e,t){var n,a,o=this,i={},r={id:e.attr("id")?e.attr("id")+"_popupLstVw":(new Date).getTime()+"_popupLstVw",timedClose:!1,onClick:!1,onClose:!1,overlayTheme:"b",dataDismissible:!0,closeButton:!0,headingCaption:"",css:{width:"430px","background-color":"#ffffff !important"}};r=$.extend(!0,r,t),n=r.divRef;var c=(new Date).getTime();$(n).attr("id")&&(c=$(n).attr("id")),$(n).attr({"data-role":"popup","data-position-to":"window","data-overlay-theme":r.overlayTheme,"data-corners":"true","data-theme":"a","data-shadow":"true","data-tolerance":"0,0","data-dismissible":r.dataDismissible?"true":"false"}).css(r.css),$(n).bind({popupafterclose:function(){a&&clearTimeout(a),r.onClose&&r.onClose()}});var d=$("<div></div>").attr({"data-role":"header","data-theme":"b"});$(d).appendTo($(n));var s=$("<h1>"+r.headingCaption+"</h1>");if($(s).appendTo($(d)),r.closeButton){var l=$("<a></a>").attr({"data-rel":"back"}).addClass("ui-btn ui-corner-all ui-shadow ui-btn ui-icon-delete ui-btn-icon-notext ui-btn-right");$(l).appendTo($(d))}var u=$("<div></div>").css({"overflow-y":"auto"}).addClass("ui-content");$(u).appendTo($(n));var p=$("<ul></ul>").attr({"data-role":"listview","data-inset":"true"}).css({width:"100%"});$(p).appendTo($(u)),$(n).trigger("create"),$(n).popup(),this.test=function(){var e=$.extend(!0,{},r);e.divRef=!1,alert(JSON.stringify(e))},this.open=function(){$(n).popup("open"),console.log("options.timedClose:"+r.timedClose),r.timedClose&&(a&&clearTimeout(a),a=setTimeout(function(){$(n).popup("close")},r.timedClose))},this.addItem=function(e){var t,a={id:(new Date).getTime(),template:0,data:!1};return a=$.extend(!0,a,e),i[a.id]={template:a.template,data:a.data},o.addItem.$clickableDiv=!1,0==a.template&&(t=h(a)),console.log("clickableDiv"),console.dir(o.addItem.$clickableDiv),o.addItem.$clickableDiv&&($(o.addItem.$clickableDiv).attr("refId",a.id),$(o.addItem.$clickableDiv).click(function(){r.onClick&&r.onClick($(this).attr("refId"),i[$(this).attr("refId")])})),$(p).listview("refresh"),f(n),t};var h=function(e){var t={useDataIcon:!1,liCss:{},liClass:"",fontColor:"#000000",imageUrl:"",imageCss:{height:"64px"},imageClass:"magicSquare",caption:"",details:!1,html:!1,zOrder:!1};t=$.extend(!0,t,e);var n=$("<li></li>").attr({"data-icon":t.useDataIcon?"true":"false"}).css(t.liCss).addClass(t.liClass);t.zOrder?$(p).prepend($(n)):$(n).appendTo($(p));var a=$("<a></a>").css({color:t.fontColor});if($(a).appendTo($(n)),o.addItem.$clickableDiv=$(a),t.imageUrl){var i=$("<img></img>").attr({src:t.imageUrl}).css(t.imageCss).addClass(t.imageClass);$(i).appendTo($(a))}var r=$("<h2>"+t.caption+"</h2>");if($(r).appendTo($(a)),t.html){var c=$("<div></div>");$(c).html(t.html),$(c).appendTo($(a))}if(t.details)for(var d in t.details){var s=$("<p>"+t.details[d]+"</p>");$(s).appendTo($(a))}return t.id},f=function(e){var t=$(e).find(".ui-content"),n=0,a=.9*$.mobile.getScreenHeight();console.log("--------setThePopupHeight----------------"),$(e).find("ul").each(function(){console.log("ul"),"listview"==$(this).attr("data-role")&&(console.log("data-role"),$(this).children("li").each(function(){console.log("----------- li ----------------------------"),console.log("height:"+$(this).height()),n+=$(this).outerHeight()+20}))}),n>a?(console.log("using max:"+a),$(t).height(a)):(console.log("using calculatedHeight:"+n),$(t).height(n))};this.deleteItem=function(e){$(n).find("[refId='"+e+"']").each(function(){$(this).closest("li").remove()}),delete i[e],f(n)},this.clear=function(){$(n).find("li").remove()},this.setHeading=function(e){s.html(e)},this.close=function(){$(n).popup("close")},this.chainOpen=function(e){setTimeout(function(){return e&&e.constructor&&e.call&&e.apply?e():void $(e).PopupListView("open",{})},100),o.close()},this.append=function(e){var t={id:!1,html:!1};t=$.extend(!0,t,e),$(n).find("[refId='"+t.id+"']").each(function(){var e=$("<div></div>");$(e).html(t.html),$(this).append($(e))})}};$.fn.PopupListView=function(e,t){var n=$(this).data(" popupListViewInstance");if(!n||"create"==e){t.divRef=$(this),console.log("popupListView CREATED");var n=new PopupListView($(this),t);return void $(this).data(" popupListViewInstance",n)}return"test"==e&&(console.log("testing123"),n.test()),"open"==e&&(console.log("open"),n.open()),"addItem"==e?(console.log("addItem"),n.addItem(t)):"deleteItem"==e?(console.log("deleteItem"),n.deleteItem(t)):"clear"==e?(console.log("clear"),n.clear(t)):"setHeading"==e?(console.log("setHeading"),n.setHeading(t)):("close"==e&&(console.log("close"),n.close()),"chainOpen"==e?(console.log("chainOpen"),n.chainOpen(t)):"append"==e?(console.log("append"),n.append(t)):void 0)};var DynamicTable=function(e,t){var n,a,o={},i={id:e.attr("id")?e.attr("id")+"_table":(new Date).getTime()+"_table",style:"","class":"",fieldHeader:[],attributes:{},onClick:!1};i=$.extend(i,t),n=i.divRef;var r=0,c=0;this.test=function(){alert("DynamicTable TEST")},i.attributes.id=i.id;var d=function(){var t=$("<table></table>").attr(i.attributes).addClass(i.class);$(e).append(t),a=$(t).attr("id");var n=$("<thead></thead>").attr({}),o=$("<tr></tr>").attr({});$(n).append(o);for(var c in i.fieldHeader){var d=$("<th></th>").attr(i.fieldHeader[c].attributes);$(o).append($(d).html(i.fieldHeader[c].caption)),r++}$(t).html(n),$(t).append('<tbody id="'+i.id+'_tbody" style=""></tbody>')};this.getTableId=function(){return a},d(),console.log("createHtmlContainer loaded"),this.addRowTop=function(e){var t=[];t=$.extend(t,e.rowArray);var n={};n=$.extend(n,e.data);var a;for(var r in t)a+="<td>"+t[r]+"</td>";var d=i.id+"_row_"+c,s='<tr id="'+d+'" index="'+c+'">'+a+"</tr>";$("#"+i.id+"_tbody").prepend(s),o[d]=n,$("#"+d).click(function(){i.onClick&&i.onClick($(this).attr("index"),o[$(this).attr("id")],$(this))}),c++,$("table#table-reflow tbody").closest("table#table-reflow").table("refresh").trigger("create")},this.addRow=function(e){var t=[];t=$.extend(t,e.rowArray);var n={};n=$.extend(n,e.data);var a;for(var r in t)a+="<td>"+t[r]+"</td>";var d=i.id+"_row_"+c,s='<tr id="'+d+'" index="'+c+'">'+a+"</tr>";$("#"+i.id+"_tbody").append(s),o[d]=n,$("#"+d).click(function(){i.onClick&&i.onClick($(this).attr("index"),o[$(this).attr("id")],$(this))}),c++,$("table#table-reflow tbody").closest("table#table-reflow").table("refresh").trigger("create")},this.clear=function(){$("#"+i.id+"_tbody").children().each(function(){$(this).remove()}),o={}}};$.fn.DynamicTable=function(e,t){var n=$(this).data("dynamicTableInstance");if(!n||"create"==e){t.divRef=$(this),console.log("dynamicTable CREATED");var n=new DynamicTable($(this),t);return void $(this).data("dynamicTableInstance",n)}return"test"==e&&n.test(),"addRow"==e?n.addRow(t):"addRowTop"==e?n.addRowTop(t):"getTableId"==e?n.getTableId(t):"clear"==e?n.clear():void 0};